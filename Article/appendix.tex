\section{Approximation of the genotypic variogram}\label{app:approx}

We give here arguments to justify that the function
$$
\gamma(h) = \frac{1}{2 |N(h)|} \sum_{i,j \in N(h)} \frac{1}{L} \sum_{l} |Y_{i,l} - Y_{j,l}|
$$
can be approximated by the function 
$$\hat{\gamma}(h) = {Cst}_0 \frac{1}{2 |N(h)|} \sum_{i,j \in N(h)} \| {\bf Q}_{i,.} - {\bf Q}_{i,.}\|^2 + {Cst}_1. 
$$
We first remark that
$$
S = \frac{1}{L} \sum_l |{\bf Y}_{i,l} - {\bf Y}_{j,l}|
$$
can be approximated by is mean 
$$
E[S] = \frac{1}{L} \sum_l P(|{\bf Y}_{i,l} - {\bf Y}_{j,l}| = 1)
$$
because 
$$
Var(S) = \frac{1}{L^2} \sum_l P(|{\bf Y}_{i,l} - {\bf Y}_{j,l}| = 1) 
( 1 - P(|{\bf Y}_{i,l} - {\bf Y}_{j,l}| = 1)).
$$
The notations $Var$ and $E$ stand for the the mean and the variance. Then, we can show that 
$$
P(|{\bf Y}_{i,l} - {\bf Y}_{j,l}| = 1) = ({\bf P}_{i,l} - {\bf P}_{j,l})^2 + {\bf P}_{i,l} (1 - {\bf P}_{i,l}) + {\bf P}_{j,l} (1 - {\bf P}_{j,l}),
$$
\noindent where ${\bf P}$ is the matrix of probability. Each value of the matrix ${\bf P}$ represents the probability to observe ${\bf Y}_{j,l} = 1$. Moreover, under the TESS3 model assumption, we have ${\bf P} = {\bf Q} {\bf G}^T$, where ${\bf Q}$ and ${\bf G}$ are the ancestry matrices. So, we have
$$
\sum_{i,j \in N(h)} \frac{1}{L} \sum_{l} ({\bf P}_{i,l} - {\bf P}_{j,l})^2 = {Cst}_0 \sum_{i,j \in N(h)} \| {\bf Q}_{i,.} - {\bf Q}_{i,.}\|^2
$$
where ${Cst}_0 = \frac{1}{L} \sum_{l} \sum_{k} {\bf G}_{k,l}^2$.
Finally, if we assume that 
$$
{Cst}_1 = \frac{1}{|N(h)|} \sum_{i,j \in N(h)} \frac{1}{L} \sum_l  {\bf P}_{i,l} (1 - {\bf P}_{i,l})
$$
is constant $\forall h$ we can approximate $\gamma$ by $\hat{\gamma}$. 




\section{Algorithms}\label{app:algo}

\begin{algo}
	AQP algorithm pseudo code. To solve optimization problem~\eqref{eq:LS}.
    
\begin{algorithm}[H]
 \KwIn{ the data matrix ${\bf Y} \in \{0,1\}^{n \times (p+1) L}$, the Laplacian matrix  ${\bf \Lambda} \in \mathbb{R}^{n \times n}$, the number of ancestral populations $K$, the regularization coefficient  $\alpha$, the maximum number of iteration $itMax$}
 
 \KwOut{the admixture coefficients matrix ${\bf Q} \in \mathbb{R}^{n \times K}$, the ancestral genotype frequencies matrix ${\bf G} \in \mathbb{R}^{K \times (p+1) L}$ }
 
 \BlankLine
  
 Initialize ${\bf Q}$ at random \;
	
 \For{$it = 1..itMax$}{
	 \BlankLine
	 // G optimization step
	
      \For{$l = 1..L$}{
			$Y^l \leftarrow {\bf Y}_{., (d+1)l..(d+1)l + d}$ \;
		    $ {\bf D}_Q \leftarrow {\bf I}_{p+1} \otimes {\bf Q}^T {\bf Q}$\;
	
			$ v_Q \leftarrow Vec({\bf Q}^T Y^l)$\;
	
	      $g^\star \in \argmin_{
			       \substack{
	          g \in \Delta_G
	       }
	     } 
              - 2 v_Q^T g + g^T {\bf D}_Q g$ \;
	
	$Vec({\bf G}_{(d+1)l..(d+1)l + d,.}) \leftarrow g^\star$ \;
	 }
	 \BlankLine
	// Q optimization step
	
	$ {\bf D}_G \leftarrow Id_{n} \otimes {\bf G}^T {\bf G} + \alpha {\bf \Lambda} \otimes {\bf I}_{K}$ \;
	
	 $ v_G \leftarrow Vec({\bf G}^T {\bf Y}^T)$ \;
	
      $Vec({\bf Q}^T) \in \argmin_{%
	       \substack{%
	          q \in \Delta_Q
	       }
	     } 
	     - 2 v_G^T q + q^T {\bf D}_G q$\;
	 }
\end{algorithm}
\label{algo:aqp}
\end{algo}

\begin{algo}
APLS algorithm pseudo code. To solve the optimization problem~\eqref{eq:LS}.

\begin{algorithm}[H]
\KwIn{ the data matrix ${\bf Y} \in \{0,1\}^{n \times (d+1) L}$, the eigen values and vectors matrices ${\bf U}$ and ${\bf D}$ such that ${\bf \Lambda} = {\bf U}^T {\bf D} {\bf U}$, the number of ancestral populations $K$, the regularization coefficient  $\alpha$, the maximum number of iteration $itMax$}

\KwOut{the admixture coefficients matrix ${\bf Q} \in \mathbb{R}^{n \times K}$, the ancestral genotype frequencies matrix ${\bf G} \in \mathbb{R}^{K \times (d+1) L}$ }

 \BlankLine
 
 Initialize ${\bf Q}$ at random \;

 $proj({\bf Y}) \leftarrow {\bf R} {\bf Y}$ \;

 \For{$it = 1..itMax$}{	 
 	\BlankLine
	 // F optimization step

	\For{$j = 1..(p+1)L$}{

	$g^\star \in \argmin_{%
	       \substack{%
	          g \in \mathbb{R}^{K}
	       }
	       }
	     || {\bf Y}_{., j} - {\bf Q} g||^2$\;

 ${\bf G}_{j,.} \leftarrow g^\star $\;
 }

 Project ${\bf G}$ such that ${\bf G} \in \Delta_G$ \;
 	\BlankLine
	 // Q optimization step

 \For{$i = 1..n$}{
 $g^\star_i \in \argmin_{%
       \substack{%
          q \in \mathbb{R}^{K}
       }
       }
     || proj({\bf Y})_{i,.} - {\bf G}^T q ||^2 + \lambda {\bf D}_{i,i} ||q||^2$\;

 $proj({\bf Q})_{i, .} \leftarrow g^\star_i $\;
 }

 ${\bf Q} \leftarrow {\bf U}^T proj({\bf Q})$\;

Project ${\bf Q}$ such that ${\bf Q} \in \Delta_Q$ \;
 }


 \end{algorithm}
\label{algo:apls}
\end{algo}

